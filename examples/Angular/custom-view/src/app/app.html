<div style="max-width: 1000px; margin: 0 auto; padding: 20px; font-family: sans-serif;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <div style="display: flex; gap: 8px;">
      <button (click)="calendarHook.calendar().goToPrevious()">Previous</button>
      <button (click)="calendarHook.calendar().goToToday()">Today</button>
      <button (click)="calendarHook.calendar().goToNext()">Next</button>
    </div>
    <h2 style="margin: 0;">{{ getTitle() }}</h2>
  </div>

  <div style="margin-bottom: 20px; padding: 15px; background: #f1f5f9; border-radius: 8px;">
    <strong>View Presets:</strong>
    <div style="display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap;">
      <button (click)="setPreset('day', 2)">2 Days</button>
      <button (click)="setPreset('week', 1, [1,2,3,4,5])">Work Week</button>
      <button (click)="setPreset('week', 2)">2 Weeks</button>
      <button (click)="setPreset('month', 1, [1,2,3,4,5])">1 Month Weekdays</button>
      <button (click)="setPreset('month', 3)">Quarter (3 Months)</button>
    </div>
  </div>

  <div class="view-content">
    <!-- Month View Partitioned -->
    @if (calendarHook.calendar().customViewOptions?.unit === 'month' && calendarHook.calendar().monthData) {
    <div class="month-views">
      @for (m of getMonthsToDisplay(); track m.year + '-' + m.month) {
      <div class="month-container" style="margin-bottom: 30px;">
        <div class="month-title" style="margin-top: 20px; font-weight: bold; font-size: 1.2em; margin-bottom: 10px;">
          {{ calendarHook.calendar().utils.formatLocalizedMonth(m.date) }}
        </div>
        <table border="1" style="border-collapse: collapse; width: 100%; text-align: center;">
          <thead>
            <tr>
              @for (day of calendarHook.calendar().utils.daysofWeek('short'); track day) {
              <th style="padding: 8px; background: #f8fafc;">{{ day }}</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (week of calendarHook.calendar().monthData?.weeks; track week) {
            @if (weekHasMonthDays(week, m.month, m.year)) {
            <tr>
              @for (dayIdx of [0,1,2,3,4,5,6]; track dayIdx) { @let date = getDay(week, dayIdx);
              <td [style.background]="date && isSameDay(date, todayDate) ? '#eff6ff' : 'white'" [style.height]="'100px'"
                [style.width]="'14.28%'" [style.verticalAlign]="'top'" [style.padding]="'4px'">
                @if (date && date.getMonth() === m.month) {
                <div style="text-align: right; font-size: 12px; margin-bottom: 4px;">{{ date.getDate() }}</div>
                <div style="display: flex; flex-direction: column; gap: 2px;">
                  @for (event of getEvents(date); track event.id) {
                  <div [style.background]="event.color"
                    style="color: white; padding: 2px 4px; font-size: 10px; border-radius: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    {{ event.title }}
                  </div>
                  }
                </div>
                } @else {
                <div style="background: #f8fafc; height: 100%;"></div>
                }
              </td>
              }
            </tr>
            }
            }
          </tbody>
        </table>
      </div>
      }
    </div>
    } @else {
    <!-- Week or Day View -->
    @if (calendarHook.calendar().customViewOptions?.unit === 'week' || calendarHook.calendar().customViewOptions?.unit
    === 'day') {
    @let data = calendarHook.calendar().customViewOptions?.unit === 'week' ? calendarHook.calendar().weekData :
    calendarHook.calendar().dayData;
    @if (data) {
    <table border="1" style="border-collapse: collapse; width: 100%; margin-top: 20px;">
      <thead>
        <tr style="background: #f8fafc;">
          @for (date of data.dates; track date.toISOString()) {
          <th style="padding: 10px;">
            <div style="font-size: 12px; color: #64748b;">{{ calendarHook.calendar().utils.formatDate(date, 'EEE') }}
            </div>
            <div style="font-size: 16px;">{{ date.getDate() }}</div>
          </th>
          }
        </tr>
      </thead>
      <tbody>
        <tr>
          @for (date of data.dates; track date.toISOString()) {
          <td [style.background]="isSameDay(date, todayDate) ? '#eff6ff' : 'white'"
            style="height: 150px; vertical-align: top; padding: 8px;">
            <div style="display: flex; flex-direction: column; gap: 4px;">
              @for (event of getEvents(date); track event.id) {
              <div [style.background]="event.color"
                style="color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px;">
                {{ event.title }}
              </div>
              }
            </div>
          </td>
          }
        </tr>
      </tbody>
    </table>
    }
    }
    }
  </div>
</div>